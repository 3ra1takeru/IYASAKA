# ğŸ“š GitHub â†’ ã‚µãƒ¼ãƒãƒ¼ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰

## ğŸ¯ 3ã¤ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•

### 1ï¸âƒ£ ãƒ¯ãƒ³ã‚³ãƒãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæ¨å¥¨ï¼‰
```bash
./deploy-from-github.sh
```
ã“ã‚Œã ã‘ã§è‡ªå‹•çš„ã«ï¼š
- GitHubã‹ã‚‰æœ€æ–°ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—
- å¿…è¦ãªè¨­å®šã‚’ç¢ºèªãƒ»ä¿®æ­£
- ã‚µãƒ¼ãƒãƒ¼ã¸ãƒ‡ãƒ—ãƒ­ã‚¤
- å‹•ä½œç¢ºèª

### 2ï¸âƒ£ æ‰‹å‹•ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œ
```bash
# 1. GitHubã‹ã‚‰æœ€æ–°ã‚’å–å¾—
git pull origin main

# 2. é€šå¸¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
./deploy.sh
```

### 3ï¸âƒ£ GitHub Actionsï¼ˆCI/CDï¼‰
GitHubã®Webã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‹ã‚‰ç›´æ¥ãƒ‡ãƒ—ãƒ­ã‚¤ï¼š
1. GitHubãƒªãƒã‚¸ãƒˆãƒªã®ã€ŒActionsã€ã‚¿ãƒ–ã‚’é–‹ã
2. ã€ŒDeploy to Serverã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’é¸æŠ
3. ã€ŒRun workflowã€ã‚’ã‚¯ãƒªãƒƒã‚¯

## ğŸ”§ åˆæœŸè¨­å®š

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ
```bash
# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸
chmod +x deploy-from-github.sh
chmod +x deploy.sh
```

### GitHub Actionsè¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
ãƒªãƒã‚¸ãƒˆãƒªã® Settings â†’ Secrets and variables â†’ Actions ã§ä»¥ä¸‹ã‚’è¨­å®šï¼š

| Secretå | å€¤ | èª¬æ˜ |
|---------|-----|------|
| SSH_PRIVATE_KEY | ~/.ssh/id_ed25519_newã®å†…å®¹ | ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šç”¨ã®ç§˜å¯†éµ |
| SSH_HOST | os3-318-48990.vs.sakura.ne.jp | ã‚µãƒ¼ãƒãƒ¼ã®ãƒ›ã‚¹ãƒˆå |
| SSH_USER | ubuntu | SSHãƒ¦ãƒ¼ã‚¶ãƒ¼å |
| SITE_URL | https://os3-318-48990.vs.sakura.ne.jp/iyasaka/ | ã‚µã‚¤ãƒˆã®URL |
| GEMINI_API_KEY | ï¼ˆAPIã‚­ãƒ¼ï¼‰ | Gemini APIã‚­ãƒ¼ï¼ˆå¿…è¦ãªå ´åˆï¼‰ |

## ğŸ“‹ deploy-from-github.sh ã®æ©Ÿèƒ½

1. **ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã®ä¿è­·**
   - æœªã‚³ãƒŸãƒƒãƒˆã®å¤‰æ›´ã‚’è‡ªå‹•ã‚¹ã‚¿ãƒƒã‚·ãƒ¥
   - ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã«å¾©å…ƒå¯èƒ½

2. **è‡ªå‹•è¨­å®šä¿®æ­£**
   - vite.config.tsã®baseè¨­å®šã‚’è‡ªå‹•ç¢ºèªãƒ»ä¿®æ­£
   - ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•ä¿®æ­£

3. **é€²æ—è¡¨ç¤º**
   - ã‚«ãƒ©ãƒ•ãƒ«ãªé€²æ—è¡¨ç¤º
   - å„ã‚¹ãƒ†ãƒƒãƒ—ã®æˆåŠŸ/å¤±æ•—ã‚’æ˜ç¢ºã«è¡¨ç¤º

4. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
   - ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã¯å³åº§ã«åœæ­¢
   - ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’è¡¨ç¤º

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### "Permission denied" ã‚¨ãƒ©ãƒ¼
```bash
chmod +x deploy-from-github.sh
```

### GitHubã‹ã‚‰å–å¾—ã§ããªã„
```bash
# ãƒªãƒ¢ãƒ¼ãƒˆURLã‚’ç¢ºèª
git remote -v

# æ­£ã—ã„ãƒªãƒã‚¸ãƒˆãƒªã‚’è¨­å®š
git remote set-url origin https://github.com/3ra1takeru/IYASAKA.git
```

### ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šã‚¨ãƒ©ãƒ¼
```bash
# SSHæ¥ç¶šã‚’ãƒ†ã‚¹ãƒˆ
ssh sakura-vps "echo 'Connection successful'"

# SSHè¨­å®šã‚’ç¢ºèª
cat ~/.ssh/config
```

### ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ
npm run build

# Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
node --version  # æ¨å¥¨: v20ä»¥ä¸Š
```

## ğŸ“ ä½¿ç”¨ä¾‹

### é€šå¸¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
# GitHubã®æœ€æ–°ã‚’å–å¾—ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤
./deploy-from-github.sh
```

### ç·Šæ€¥ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’ä¿æŒï¼‰
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã®å¤‰æ›´ã‚’ä¸€æ™‚çš„ã«é€€é¿ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤
./deploy-from-github.sh
# â†’ "y" ã‚’é¸æŠã—ã¦ã‚¹ã‚¿ãƒƒã‚·ãƒ¥
# â†’ ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã€"y" ã‚’é¸æŠã—ã¦å¤‰æ›´ã‚’å¾©å…ƒ
```

### ç‰¹å®šãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
# ãƒ–ãƒ©ãƒ³ãƒã‚’åˆ‡ã‚Šæ›¿ãˆã¦ã‹ã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤
git checkout feature-branch
git pull origin feature-branch
./deploy.sh
```

## ğŸ”„ æ›´æ–°ãƒ•ãƒ­ãƒ¼

```mermaid
graph LR
    A[GitHub] -->|git pull| B[ãƒ­ãƒ¼ã‚«ãƒ«]
    B -->|deploy-from-github.sh| C[ã‚µãƒ¼ãƒãƒ¼]
    C -->|https://| D[æœ¬ç•ªã‚µã‚¤ãƒˆ]
```

## ğŸ“Œ é‡è¦ãªæ³¨æ„äº‹é …

1. **vite.config.ts**: `base: '/iyasaka/'` ã®è¨­å®šãŒå¿…é ˆ
2. **ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³**: distãƒ•ã‚©ãƒ«ãƒ€ã¯755ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹
3. **Node.js**: ã‚µãƒ¼ãƒãƒ¼ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„å ´åˆã¯è­¦å‘ŠãŒå‡ºã‚‹ãŒå‹•ä½œã™ã‚‹
4. **.env.local**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚åŒæœŸã•ã‚Œãªã„

## ğŸ¯ ã‚¯ã‚¤ãƒƒã‚¯ã‚³ãƒãƒ³ãƒ‰é›†

```bash
# çŠ¶æ…‹ç¢ºèª
git status                    # ãƒ­ãƒ¼ã‚«ãƒ«ã®çŠ¶æ…‹
git log --oneline -5         # æœ€è¿‘ã®ã‚³ãƒŸãƒƒãƒˆ
curl -I https://os3-318-48990.vs.sakura.ne.jp/iyasaka/  # ã‚µã‚¤ãƒˆã®çŠ¶æ…‹

# ãƒ‡ãƒ—ãƒ­ã‚¤
./deploy-from-github.sh      # GitHub â†’ ã‚µãƒ¼ãƒãƒ¼
./deploy.sh                   # ãƒ­ãƒ¼ã‚«ãƒ« â†’ ã‚µãƒ¼ãƒãƒ¼

# ãƒ‡ãƒãƒƒã‚°
ssh sakura-vps "tail -f /var/log/nginx/marche_error.log"  # ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
ssh sakura-vps "ls -la ~/iyasaka/dist/"                    # ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
```